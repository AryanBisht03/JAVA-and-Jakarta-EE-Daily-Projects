package jdbcproject;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Connection;
import java.util.*;
public class Student_management {
public static void main(String[] args)throws Exception {
	Scanner scanner=new Scanner(System.in);
	
	try
	{
		Class.forName("com.mysql.cj.jdbc.Driver");
		String URL="jdbc:mysql://localhost:3306/jdbc_db";
		String DB="root";
		System.out.println("Enter password");
		String Password=scanner.nextLine();	
		Connection con=DriverManager.getConnection(URL,DB,Password);
		int errorcodevita=1;
		while(errorcodevita==1)
		{
			System.out.println("1.Add Student");
			System.out.println("2.View all students");
			System.out.println("3.Update student marks");
			System.out.println("4.Delete student");
			System.out.println("5.Exit");
			System.out.println("Enter your choice:");
			int input=scanner.nextInt();
			scanner.nextLine();
			switch(input)
			{
			case 1:
				System.out.println("Enter student name:");
				String name=scanner.nextLine();
				System.out.println("Enter student email");
				String email=scanner.nextLine();
				System.out.println("Enter student number");
				int marks=scanner.nextInt();
				scanner.nextLine();
				PreparedStatement ps=con.prepareStatement("insert into student(name,email,marks)values(?,?,?)");
				ps.setString(1, name);
				ps.setString(2,email);
				ps.setInt(3, marks);
				int count=ps.executeUpdate();
				if(count>0)
					System.out.println("Updated");
				else
					System.out.println("Not updated");
				break;
				
			case 2:
				ps=con.prepareStatement("select * from student");
				ResultSet rs=ps.executeQuery();
				while(rs.next())
				{
					int roll_no=rs.getInt("id");
					String name1=rs.getString("name");
					String email1=rs.getString("email");
					int marks1=rs.getInt("marks");
					System.out.println("Roll number: "+roll_no);
					System.out.println("Name: "+name1);
					System.out.println("Email: "+email1);
					System.out.println("Marks: "+marks1);
					System.out.println();
					System.out.println();
				}
				break;
				
			case 3:
				System.out.println("Enter student marks");
				marks=scanner.nextInt();
				scanner.nextLine();
				System.out.println("Enter emailid");
				email=scanner.nextLine();
				ps=con.prepareStatement("update student set marks=? where email=?");
				ps.setInt(1, marks);
				ps.setString(2, email);
				int count2=ps.executeUpdate();
				if(count2>0)
					System.out.println("Updated");
				else
					System.out.println("Not updated");
				break;
				
			case 4:
				System.out.println("Enter student email");
				email=scanner.nextLine();
				ps=con.prepareStatement("delete from student where email=?");
				ps.setString(1, email);
				int count3=ps.executeUpdate();
				if(count3>0)
					System.out.println("Deleted");
				else
					System.out.println("Not deleted");
				break;
				
			case 5:
				break;
			}
		System.out.println("Do you want to continue? if Yes then press 1 else 0");
		errorcodevita=scanner.nextInt();
		if(errorcodevita!=1)
			break;
		}
		
	}
	catch(ClassNotFoundException e)
	{
		System.out.println("MySql Driver not found");
	}
	catch(SQLException e)
	{
		System.out.println("Database Error: "+e.getMessage());
	}
	catch(Exception e)
	{
		System.out.println("Error: "+e.getMessage());
	}
}
}
